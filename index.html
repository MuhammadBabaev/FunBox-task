<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Get me :)</title>
    <link rel="stylesheet" href="files/style/style.css">
  </head>
  <body>
    <header class="bgshadow"></header>
    <div class="container">
      <header class="welcome_header">
        <h1>Ты сегодня покормил кота?</h1>
      </header>
      <div class="products">
        <div class="product_wrapper">
          <div class="product product_1" onclick="checkIt(this)">
            <div class="about">
              <p class="tagline">Сказочное заморское яство</p>
              <h1 class="brand">Нямушка</h1>
              <h3 class="withwhat">с фуа-гра</h3>
              <p class="gifts">10 порций<br>мышь в подарок</p>
              <div class="weight">
                <p class="number">0,5</p>
                <p class="measure">кг</p>
              </div>
              <div class="change_icon">
                <div class="checkmark"></div>
              </div>
            </div>
          </div>
          <p class="subtext">Чего сидишь? Порадуй котэ, <a href="#">купи</a>.</p>
        </div>
        <div class="product_wrapper">
          <div class="product product_2" onclick="checkIt(this)">
            <div class="about">
              <p class="tagline">Сказочное заморское яство</p>
              <h1 class="brand">Нямушка</h1>
              <h3 class="withwhat">с рыбой</h3>
              <p class="gifts">40 порций<br>2 мыши в подарок</p>
              <div class="weight">
                <p class="number">2</p>
                <p class="measure">кг</p>
              </div>
              <div class="change_icon">
                <div class="checkmark"></div>
              </div>
            </div>
          </div>
          <p class="subtext">Головы щучьи с чесноком да свежайшая сёмгушка.</p>
        </div>
        <div class="product_wrapper">
          <div class="product product_3 product_ended" onclick="checkIt(this)">
            <div class="about">
              <p class="tagline">Сказочное заморское яство</p>
              <h1 class="brand">Нямушка</h1>
              <h3 class="withwhat">с курой</h3>
              <p class="gifts">100 порций<br>5 мышей в подарок<br>закзчик доволен</p>
              <div class="weight">
                <p class="number">5</p>
                <p class="measure">кг</p>
              </div>
              <div class="change_icon">
                <div class="checkmark"></div>
              </div>
            </div>
          </div>
          <p class="subtext product_ended_subtext">Печалька, с курой закончился.</p>
        </div>
      </div>
    </div>
    <footer class="bgshadow bgshadow_bottom"></footer>
  </body>
  <script type="text/javascript">
    onresize = function(){
      // resizeProductDivs("product");
      resizeBaseContainer('container');
    }

    function checkIt(product){
      productIcon = product.getElementsByClassName('change_icon')[0];
      let cl = '';
      for (let i = 0; i < product.classList.length; i++){
        if (product.classList[i] == 'product_ended') cl = 'product_ended';
      }
      if ((getComputedStyle(productIcon).display == 'none') && (cl != 'product_ended')){
        productIcon.style.display = 'block';
      } else {
        productIcon.style.display = 'none';
      }
    }

    // function resizeProductDivs(className){
    //   // Resizing product blocks height
    //   let products = document.getElementsByClassName(className);
    //   let productWidth = Number((getComputedStyle(products[0]).width).slice(0, -2));
    //   let productHeight = Number((getComputedStyle(products[0]).height).slice(0, -2));
    //   for (let i = 0; i < products.length; i++){
    //     products[i].style.height = String(productWidth * 1.5) +  "px";
    //   }

      // Resizing cut angle border
      // const maskTriDep = 0.14333639345;  //Mask Triangle Dependency
      // let newTopRight = String(productWidth * maskTriDep) + "px";
      // let newAfter = document.head.appendChild(document.createElement("style"));
      // newAfter.innerHTML = ".product:after {width: 0; height: 0;" +
      // " display: block; content: ''; border-top: "+ newTopRight +" solid #eee;" +
      // " border-right: "+ newTopRight +" solid transparent;}";

      // const scaleDivDep = 0.00341277127;
      // let aboutBlock = document.querySelectorAll(".about");
      // for (let i = 0; i < aboutBlock.length; i++){
      //   aboutBlock[i].getElementsByTagName('h1')[0].style.transform = "scale(" + productWidth * scaleDivDep + ")";
      // }

      // let about = document.querySelectorAll(".about");
      // for (let i = 0; i < about.length; i++){
      //   for (let j = 0; j < about[i].children.length; j++){
      //     let el = about[i].children[j];
      //     let eWidth = getComputedStyle(el).fontSize.slice(0,-2);
      //     let eHeight = getComputedStyle(el).fontSize.slice(0,-2);
      //     let scale = Math.min(
      //       0.1433 * productWidth
      //     );
      //     console.log("scale: " + scale);
      //     console.log("eWidth: " + eWidth);
      //     console.log("productWidth: " + productWidth);
      //     console.log("----------------------");
      //     el.style.fontSize = scale + "px";
      //   }
      // }
      // let scale =  Math.min(
      //   productWidth/
      // );
    // }

    function resizeBaseContainer(className){
      let container = document.getElementsByClassName(className)[0]; // base container
      let containerHeight = container.clientHeight; //base container height
      let windowHeight = document.body.clientHeight; // user window height
      if (containerHeight < windowHeight){
        container.style.height = containerHeight +
        (windowHeight - containerHeight - 2) + 'px';
      }
    }

    onresize();
  </script>
</html>
